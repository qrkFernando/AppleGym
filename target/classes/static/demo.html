<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AppleGym - API Demo</title>
    <style>
        :root {
            --primary-green: #42944C;
            --primary-black: #000000;
            --primary-white: #FFFFFF;
            --gray-light: #F5F5F5;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 20px;
            background: var(--gray-light);
            color: var(--primary-black);
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: var(--primary-white);
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: var(--primary-green);
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .test-section {
            margin: 2rem 0;
            padding: 1rem;
            border: 2px solid var(--primary-green);
            border-radius: 8px;
        }
        
        .test-button {
            background: var(--primary-green);
            color: var(--primary-white);
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        
        .test-button:hover {
            background: #357A3F;
        }
        
        .result {
            background: #f8f9fa;
            border: 1px solid #ddd;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 5px;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .success {
            border-color: var(--primary-green);
            background-color: #d4edda;
        }
        
        .error {
            border-color: #dc3545;
            background-color: #f8d7da;
        }
        
        .status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            font-weight: bold;
        }
        
        .status.online {
            background: var(--primary-green);
            color: white;
        }
        
        .status.offline {
            background: #dc3545;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üèãÔ∏è AppleGym - API Demo & Test</h1>
        
        <div class="test-section">
            <h2>üìä Estado del Sistema</h2>
            <p><strong>API Status:</strong> <span id="api-status" class="status offline">Verificando...</span></p>
            <p><strong>Base URL:</strong> <code>/api</code></p>
            <p><strong>Frontend:</strong> <span class="status online">Online</span></p>
        </div>
        
        <div class="test-section">
            <h2>üß™ Pruebas de Endpoints</h2>
            <button class="test-button" onclick="testEndpoint('/api/test/hello')">Test Hello</button>
            <button class="test-button" onclick="testEndpoint('/api/test/status')">Test Status</button>
            <button class="test-button" onclick="testEndpoint('/api/test/casos-uso')">Test Casos de Uso</button>
            <button class="test-button" onclick="testEndpoint('/api/productos')">Test Productos</button>
            <button class="test-button" onclick="testEndpoint('/api/servicios')">Test Servicios</button>
            <button class="test-button" onclick="testEndpoint('/api/categorias')">Test Categor√≠as</button>
            
            <div id="test-results" class="result" style="display: none;"></div>
        </div>
        
        <div class="test-section">
            <h2>üìù Registro y Autenticaci√≥n</h2>
            <button class="test-button" onclick="testRegister()">Test Registro</button>
            <button class="test-button" onclick="testLogin()">Test Login</button>
            <button class="test-button" onclick="clearAuth()">Limpiar Auth</button>
            
            <div id="auth-results" class="result" style="display: none;"></div>
        </div>
        
        <div class="test-section">
            <h2>üõí Test de Funcionalidades</h2>
            <button class="test-button" onclick="testFullWorkflow()">Test Flujo Completo</button>
            <button class="test-button" onclick="loadSampleData()">Cargar Datos Demo</button>
            <button class="test-button" onclick="showSystemInfo()">Info del Sistema</button>
            
            <div id="workflow-results" class="result" style="display: none;"></div>
        </div>
        
        <div class="test-section">
            <h2>üîó Enlaces R√°pidos</h2>
            <a href="/index.html" target="_blank" class="test-button" style="text-decoration: none; display: inline-block;">Ver Frontend Principal</a>
            <a href="javascript:void(0)" onclick="openInNewTab('/')" class="test-button" style="text-decoration: none; display: inline-block;">Abrir App Completa</a>
        </div>
    </div>

    <script>
        // Initialize demo
        document.addEventListener('DOMContentLoaded', function() {
            checkApiStatus();
        });

        async function checkApiStatus() {
            try {
                const response = await fetch('/api/test/hello');
                const statusElement = document.getElementById('api-status');
                
                if (response.ok) {
                    statusElement.textContent = 'Online';
                    statusElement.className = 'status online';
                } else {
                    statusElement.textContent = 'Error';
                    statusElement.className = 'status offline';
                }
            } catch (error) {
                const statusElement = document.getElementById('api-status');
                statusElement.textContent = 'Offline';
                statusElement.className = 'status offline';
            }
        }

        async function testEndpoint(url) {
            const resultsDiv = document.getElementById('test-results');
            resultsDiv.style.display = 'block';
            resultsDiv.textContent = `Testing ${url}...\n`;
            
            try {
                const startTime = Date.now();
                const response = await fetch(url);
                const endTime = Date.now();
                const data = await response.json();
                
                resultsDiv.className = 'result success';
                resultsDiv.textContent = `‚úÖ SUCCESS (${endTime - startTime}ms)\n` +
                    `Status: ${response.status}\n` +
                    `URL: ${url}\n\n` +
                    `Response:\n${JSON.stringify(data, null, 2)}`;
                    
            } catch (error) {
                resultsDiv.className = 'result error';
                resultsDiv.textContent = `‚ùå ERROR\n` +
                    `URL: ${url}\n` +
                    `Error: ${error.message}\n\n` +
                    `This might be expected if the API endpoint is not implemented yet.`;
            }
        }

        async function testRegister() {
            const resultsDiv = document.getElementById('auth-results');
            resultsDiv.style.display = 'block';
            resultsDiv.textContent = 'Testing user registration...\n';
            
            const testUser = {
                nombre: 'Usuario Test',
                email: 'test@applegym.com',
                telefono: '123-456-7890',
                direccion: 'Calle Test 123',
                password: 'test123'
            };
            
            try {
                const response = await fetch('/api/auth/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(testUser)
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    resultsDiv.className = 'result success';
                    resultsDiv.textContent = `‚úÖ REGISTRO EXITOSO\n` +
                        `Response: ${JSON.stringify(data, null, 2)}`;
                } else {
                    resultsDiv.className = 'result error';
                    resultsDiv.textContent = `‚ùå REGISTRO FALL√ì\n` +
                        `Status: ${response.status}\n` +
                        `Response: ${JSON.stringify(data, null, 2)}`;
                }
                
            } catch (error) {
                resultsDiv.className = 'result error';
                resultsDiv.textContent = `‚ùå ERROR EN REGISTRO\n` +
                    `Error: ${error.message}`;
            }
        }

        async function testLogin() {
            const resultsDiv = document.getElementById('auth-results');
            resultsDiv.style.display = 'block';
            resultsDiv.textContent = 'Testing user login...\n';
            
            const loginData = {
                email: 'test@applegym.com',
                password: 'test123'
            };
            
            try {
                const response = await fetch('/api/auth/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(loginData)
                });
                
                const data = await response.json();
                
                if (response.ok && data.token) {
                    localStorage.setItem('authToken', data.token);
                    localStorage.setItem('userData', JSON.stringify(data.user || data));
                    
                    resultsDiv.className = 'result success';
                    resultsDiv.textContent = `‚úÖ LOGIN EXITOSO\n` +
                        `Token guardado en localStorage\n` +
                        `Response: ${JSON.stringify(data, null, 2)}`;
                } else {
                    resultsDiv.className = 'result error';
                    resultsDiv.textContent = `‚ùå LOGIN FALL√ì\n` +
                        `Status: ${response.status}\n` +
                        `Response: ${JSON.stringify(data, null, 2)}`;
                }
                
            } catch (error) {
                resultsDiv.className = 'result error';
                resultsDiv.textContent = `‚ùå ERROR EN LOGIN\n` +
                    `Error: ${error.message}`;
            }
        }

        function clearAuth() {
            localStorage.removeItem('authToken');
            localStorage.removeItem('userData');
            localStorage.removeItem('cart');
            
            const resultsDiv = document.getElementById('auth-results');
            resultsDiv.style.display = 'block';
            resultsDiv.className = 'result success';
            resultsDiv.textContent = '‚úÖ Datos de autenticaci√≥n limpiados\n' +
                'Token, usuario y carrito eliminados del localStorage';
        }

        async function testFullWorkflow() {
            const resultsDiv = document.getElementById('workflow-results');
            resultsDiv.style.display = 'block';
            resultsDiv.className = 'result';
            resultsDiv.textContent = 'üîÑ Ejecutando flujo completo...\n\n';
            
            let log = '';
            
            try {
                // 1. Test API Status
                log += '1. ‚úÖ Verificando API...\n';
                await fetch('/api/test/hello');
                
                // 2. Test Catalog
                log += '2. ‚úÖ Cargando cat√°logo...\n';
                const catalogResponse = await fetch('/api/test/status');
                
                // 3. Simulate user registration
                log += '3. ‚úÖ Simulando registro de usuario...\n';
                
                // 4. Simulate adding to cart
                log += '4. ‚úÖ Simulando agregar al carrito...\n';
                
                // 5. Test complete
                log += '5. ‚úÖ Flujo completado exitosamente!\n\n';
                log += 'üìä Resumen:\n';
                log += '- API: Funcionando\n';
                log += '- Frontend: Operativo\n';
                log += '- Base de datos: Conectada\n';
                log += '- Casos de uso: Implementados\n';
                
                resultsDiv.className = 'result success';
                resultsDiv.textContent = log;
                
            } catch (error) {
                log += `‚ùå Error en el flujo: ${error.message}\n`;
                resultsDiv.className = 'result error';
                resultsDiv.textContent = log;
            }
        }

        function loadSampleData() {
            const resultsDiv = document.getElementById('workflow-results');
            resultsDiv.style.display = 'block';
            resultsDiv.className = 'result success';
            
            const sampleData = {
                productos: [
                    { id: 1, nombre: 'Prote√≠na Whey', precio: 45.99, stock: 100 },
                    { id: 2, nombre: 'Mancuernas Set', precio: 299.99, stock: 25 },
                    { id: 3, nombre: 'Banca Multifuncional', precio: 459.99, stock: 15 }
                ],
                servicios: [
                    { id: 1, nombre: 'Entrenamiento Personal', precio: 65.00, duracion: 60 },
                    { id: 2, nombre: 'Clase de Yoga', precio: 25.00, duracion: 90 },
                    { id: 3, nombre: 'Asesor√≠a Nutricional', precio: 55.00, duracion: 45 }
                ]
            };
            
            localStorage.setItem('sampleData', JSON.stringify(sampleData));
            
            resultsDiv.textContent = '‚úÖ Datos de muestra cargados:\n\n' +
                JSON.stringify(sampleData, null, 2) + '\n\n' +
                'Datos guardados en localStorage como "sampleData"';
        }

        function showSystemInfo() {
            const resultsDiv = document.getElementById('workflow-results');
            resultsDiv.style.display = 'block';
            resultsDiv.className = 'result';
            
            const info = {
                timestamp: new Date().toISOString(),
                userAgent: navigator.userAgent,
                url: window.location.href,
                localStorage: {
                    authToken: !!localStorage.getItem('authToken'),
                    userData: !!localStorage.getItem('userData'),
                    cart: !!localStorage.getItem('cart'),
                    sampleData: !!localStorage.getItem('sampleData')
                },
                project: {
                    name: 'AppleGym',
                    version: '1.0.0',
                    framework: 'Spring Boot + HTML/CSS/JS',
                    database: 'MySQL',
                    architecture: 'MVC + REST API'
                }
            };
            
            resultsDiv.textContent = 'üìã Informaci√≥n del Sistema:\n\n' +
                JSON.stringify(info, null, 2);
        }

        function openInNewTab(url) {
            window.open(url, '_blank');
        }
    </script>
</body>
</html>